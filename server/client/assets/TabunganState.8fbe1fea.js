import{f as a,g as n,u as t,h as i}from"./index.b73d235c.js";import{a as e}from"./Services.3fb9b37a.js";const o=a({isLoading:!1,isResultDialog:!1,dialogType:"loading"}),s=a({isLoading:!1,tabungans:[],formtabungan:{nominal:"",description:"",receipt:"",receiptname:"",tabungantype:"",filename:"Pilih"},amountDeposit:0});function c(){const a=t(),c=i();function u(){o.isLoading=!0,o.isResultDialog=!1}function p(){o.isLoading=!1}function d(){o.isLoading=!1,o.isResultDialog=!0,o.dialogType="success"}function g(){o.isLoading=!1,o.isResultDialog=!0,o.dialogType="failed"}return{getAllDeposit:async function(){const{success:a,data:n}=await e.get({path:"/api/deposits"});a&&n&&(s.tabungans=n.data)},sendDeposit:async function(){if(!s.formtabungan.nominal&&!s.formtabungan.description&&!s.formtabungan.receipt)return;u();const a=new FormData,t=await n();a.append("sender",t.uid),a.append("nominal",s.formtabungan.nominal),a.append("description",s.formtabungan.description),a.append("receipt",s.formtabungan.receipt),a.append("tabungantype","deposit"),p();const{success:i,data:c}=await e.post({path:"/api/deposit/add",body:a,type:"form-data"});i?(d(),s.formtabungan.description="",s.formtabungan.filename="",s.formtabungan.nominal="",s.formtabungan.receiptname="Pilih file",s.formtabungan.receipt=null):(o.dialogType="failed",g())},acceptDeposit:async function(a,n){u();const{success:t,data:i}=await e.post({path:"/api/deposit/accept",body:JSON.stringify({id:n,uid:a}),type:"json"});p(),t?d():g()},sendSpending:function(){},acceptSpending:function(){},getCountDeposit:async function(){const{success:a,data:n}=await e.get({path:"/api/deposit/count"});a&&n&&(s.amountDeposit=null==n?void 0:n.data[0].total)},onImagePicked:function(a){s.formtabungan.receipt=a.target.files[0],s.formtabungan.filename=a.target.files[0].name},showFailed:g,showSuccess:d,showLoading:u,dismiss:function(){o.isResultDialog=!1},isDialogSuccess:function(){return"success"==o.dialogType},isLoading:function(){return o.isLoading},isDialogResult:function(){return o.isResultDialog},gotoHome:function(){a.push({path:"/main/dashboard"})},getDepositById:async function(){return new Promise((async a=>{u();const{success:n,data:t}=await e.get({path:`/api/deposit/${c.params.id}`});p(),n&&t&&t.data.length>0?a(t.data):a(null)}))},TabunganState:s,ProcessTabunganState:o}}export{c as u};
